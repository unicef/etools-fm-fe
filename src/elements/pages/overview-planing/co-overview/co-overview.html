<!--import [polymer/polymer-element, etools-dropdown, iron-flex-layout, iron-icons, iron-collapse, etools-loading]-->

<!--import [pages-header, redux-mixin, etools-app-config, cp-details-item]-->

<dom-module id="co-overview">
    <template>
        <!-- inject styles './co-overview.scss'-->
        <style include="iron-flex iron-flex-factors iron-flex-alignment tab-inputs-styles"></style>

        <app-route route="{{route}}" pattern="/co-overview" active="{{isActive}}"></app-route>

        <paper-card>
            <div class="layout horizontal">
                <div class="filter-dropdown">
                    <etools-dropdown
                            selected="[[queryParams.cp_outcome]]"
                            label="CP Outcome"
                            placeholder="Select"
                            options="[[cpOutcomes]]"
                            option-label="name"
                            option-value="id"
                            trigger-value-change-event
                            on-etools-selected-item-changed="filterValueChanged"
                            hide-search allow-outside-scroll>
                    </etools-dropdown>
                </div>
            </div>
        </paper-card>

        <template is="dom-repeat" items="[[filteredConfigs]]" as="cp-config">
            <paper-card class="cp-output-container">
                <div class="cp-output-title layout horizontal">
                    <iron-icon icon="expand-less" hidden$="[[isDetailsOpened(cp-config.cp_output.id, openedConfig)]]" on-tap="toggleDetails" data-config-id$="[[cp-config.cp_output.id]]"></iron-icon>
                    <iron-icon icon="expand-more" hidden$="[[!isDetailsOpened(cp-config.cp_output.id, openedConfig)]]" on-tap="toggleDetails" data-config-id$="[[cp-config.cp_output.id]]"></iron-icon>
                    [[cp-config.name]]
                    <a href$="/apd/action-points/list?cp_output=[[cp-config.cp_output.id]]" target="_blank"><iron-icon icon="flag" class="flag-icon"></iron-icon></a>
                </div>

                <iron-collapse opened="[[isDetailsOpened(cp-config.cp_output.id, openedConfig)]]">
                    <div class="spinner" hidden$="[[detailsAreLoaded(cp-config.cp_output.id, fullReportLoading)]]"><etools-loading active></etools-loading></div>
                    <template is="dom-if" if="[[detailsAreLoaded(cp-config.cp_output.id, fullReportLoading)]]">
                        <cp-details-item cp-item="[[cp-config]]" full-report="[[getFullReport(cp-config.cp_output.id)]]"></cp-details-item>
                    </template>
                </iron-collapse>
            </paper-card>
        </template>

    </template>

    <!-- inject scripts './co-overview.ts'-->
</dom-module>
